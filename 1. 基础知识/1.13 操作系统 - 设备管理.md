# 设备管理
设备管理包括各种设备的分配，缓冲区的管理和实际物理IO设备的操作，通过管理达到极高设备的利用率和方便用户的目的
##  概述
设备是计算机与外界交互的工具，负责计算机与外部的输入/输出的工作。

1. 分类

- 按照数据组织分类
  - 块设备
  - 字符设备
- 按照设备功能分类
  - 输入设备
  - 输出设备
  - 存储设备
  - 网络联网设备
  - 供电设备等
- 资源分配角度
  - 独占设备
  - 共享设备
  - 虚拟设备
- 数据传输
  - 低速设备
  - 中速设备
  - 高速设备。

2. 设备管理的目标与任务

目标：提高设备的利用率，为设备提供方便、统一的界面。

任务：在多道程序的环境下，当多个进程竞争使用设备时，按一定的策略分配和管理各种设备，控制设备的各种操作，完成IO设备与主存之间的数据交换。

功能：动态掌握记录设备的状态、设备分配和释放、缓冲区管理、实现物理I/O设备的操作、提供设备使用的用户接口及设备的访问控制。

## I/O软件
设备管理软件水平决定了设备管理的利用效率。设计I/O设备的管理基本思想是分层构造。也就是把设备管理软件组织成一系列的结构层次。

I/O软件的主要目标：设备独立性、统一命名。

四层架构：
+ 中断处理程序（IO结束时唤醒驱动程序）
+ 设备驱动程序（置设备寄存器：检查状态）
+ 与设备无关的系统软件（命名、保护、阻塞、缓冲、分配）
+ 用户软件（I/O调用、格式化I/O、Spooling）。

## 相关技术
1. 通道技术：为了将数据的处理独立于CPU，减少CPU的I/O压力，让数据之间的I/O处理程序直接在通道中完成。

通道的分类：
- 字节多路通道
- 数组选择通道
- 数组多路通道

2. DMA技术：数据在主存与I/O设备间直接成块传送，不需要CPU处理。传送期间由DMA硬件完成，CPU可以不用参与。

3. 缓冲技术：提高外设利用率，使得外设尽量处于忙的状态。可以采用硬件缓冲和软件缓冲。引用原因：
   - 缓和CPU与I/O之间速度不匹配矛盾
   - 减少CPU的中断频率
   - 提高CPU与I/O设备之间的并行性

缓冲的分类：
* 单缓冲
* 双缓冲
* 多缓冲
* 环形缓冲

4. Spooling技术：使用一类物理设备模拟另一类物理设备技术，是一种将独占使用设备款变成多台虚拟设备的一种技术，也是一种速度匹配技术。

Spooling组成：
- 预输入程序
- 缓输出程序
- 井管理程序
- 输入输出井： 存放输入设备信息和作业执行的结果

输入井的作业状态：
- 提交状态
- 后备状态
- 执行状态
- 完成状态

## 磁盘调度
磁盘是多个进程的 共享设备。为了保证信息安全，系统在每一个时刻只能允许一个进程启动磁盘进行I/O操作。

1. 磁盘驱动调度。

算法：
- 先来先服务
- 最短寻道时间优先
- 扫描算法
- 单项扫描调度算法

2. 旋转调度算法：

考虑情况：
- 磁道相同，扇区不同
- 不同磁道，不同扇区
- 不同磁道，相同扇区

