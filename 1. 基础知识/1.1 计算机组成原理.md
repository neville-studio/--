# 计算机系统知识

## 1. 计算机系统基础知识

### 1.1 计算机系统硬件基本组成
- 计算机系统
  - 计算机硬件
    - CPU（中央处理单元）
      - **运算器**
      - **控制器**
    - **存储器**
      - 内部存储器
      - 外部存储器
    - 外设
      - **输入设备**
      - **输出设备**
  - 计算机软件

*加粗部分为基本计算机系统硬件*

### 1.2 中央处理单元
#### CPU功能：
* 程序控制
* 操作控制
* 时间控制
* 数据处理
* （对中断作出响应）
#### CPU功能
+ 运算器（ALU）
  - 功能
    * 执行算术运算
    * 逻辑测试和逻辑运算
  - 部件功能
    * 算术逻辑单元（ALU）：实现算术运算和逻辑运算
    * 累加寄存器（AC）：通用寄存器，对数据暂存
    * 数据缓冲寄存器（DR）：存放内存读写的指令或数据字，数据中转站
    * 状态条件寄存器（PSW）：保存算术指令和逻辑指令运行或测试结果建立的各种条件码内容
+ 控制器
  - 指令寄存器（IR）：暂存指令
  - 程序计数器（PC）：寄存信息或者计数，保存本条或下条指令的地址
  - 地址寄存器（AR）：暂存当前访问内存的地址（需要AR保持内存信息）
  - 指令译码器（ID）：对指令进行识别。对操作码进行分析解释，识别规定操作，完成所需功能
+ 寄存器组
  - 专用寄存器：有专门作用的寄存器
  - 通用寄存器：无明确用途，程序员指定。
+ 内部总线
#### 多核CPU：
内核：CPU执行的地方。包括逻辑单元、控制单元、中断处理器、运算单元。

AMD的CPU：通过直连架构连接起来，内核集成度更高。Intel的CPU：直接封装一起。

多核CPU开发目的：满足用户同时进行多任务处理的要求。

Intel的超线程技术。
### 1.3 数据表示
+ 数据在机器中用二进制表示。这里表示机器数
  + 带符号数（有符号位）
  + 无符号数（正数，无符号位）

+ 机器数中的无符号数
  + 纯整数
  + 纯小数
  + 其他数

+ 码制
  + 原码
  + 补码
  + 反码
  + 移码
  
  *补码和反码只是符号上的取反*

小数数据表示方式：
+ 定点数
+ 浮点数
  + 尾数用补码表示，小数用移码表示
  + 浮点数 = $2^{阶码}×尾数$

工业标准IEEE 754
|类型|单精度浮点型|双精度浮点型|扩充精度浮点数|
|:-:|:-:|:-:|:-:|
字长|32|64|80
尾数长度|23|52|64
符号位|1|1|1|
|指数长度|8|11|15
......|......|.......|......

规格化表示：阶码二进制值不全为0或不全为1时

非规格化的值： 阶码的二进制值全为0.指数真值是$1-{偏移量}$

特殊值： 阶码全为1.
+ 尾数为0 —— Inf（无穷大）符号位表示inf的符号，+inf或-inf
+ 尾数不全为0：NaN（不是一个数）

浮点数运算
+ 对阶（小对大）
+ 求尾数和
+ 结果规格化和溢出调整
+ 舍入处理
+ 溢出判别
  *快速运算：浮点数乘法：阶码相加，尾数相乘；浮点数除法，阶码相减，尾数相除*
### 1.4 校验码
校验，通过信息中增加冗余信息，从而实现信息的校验。

码距：编码系统中任意两个合法编码之间至少有多少个二进制位不同。

#### 奇偶校验码
包括水平奇偶校验码、垂直奇偶校验码和水平垂直奇偶校验码

用于判断信息是否有效。奇校验表示校验位表示二进制串中是否有奇数个1，偶校验的校验位表示二进制串中是否有偶数个1。 

#### 海明码

设有一串数据，n个数据位，k个校验位。满足$2^k - 1≥n+k$

编码规则：数据位：<font color=green>12345678</font>校验位：<font color=yellow>1234</font>
则编码为<font color=yellow>12</font><font color=green>1</font><font color=yellow>3</font><font color=green>234</font><font color=yellow>4</font><font color=green>567</font>

海明码在第$2^{i-1}$个位置

海明码的任何一位都是由若干个校验位来校验的

生成校验码，首先要确定位置，确定校验位的关系，最后进行异或计算即可。
要校验，将校验码和数据进行校验，四个数必须全部相同才能表示数据没错。

#### 循环冗余校验码

左边为信息码，右边为校验位。通过多项式，为k个数据产生r个校验位进行编码。长度为k+r由信息码产生，校验码越多，校验能力越强。采用模二运算。
用于数据通信领域和磁介质存储系统。

## 2. 计算机体系结构

### 2.1 计算机体系结构的发展
#### 1 概述
计算机体系结构：概念性结构、功能属性

计算机组织：体系结构的逻辑实现；

计算机实现：计算机组织的物理实现

#### 2 体系结构分类
宏观上：
- 单处理系统
- 并行处理和多处理系统
- 分布式处理系统

微观上：（并行程度）
- Flynn分类
- 冯泽云分类法
- Handler分类法
- Kuck分类法

#### 3 指令系统（ISA）
1）分类模式：
体系结构观点分类
* 操作数在CPU中存储方式
* 显式操作数数量
* 操作数位置
* 指令的操作
* 操作数类型大小

暂存机制
栈、累加器、寄存器组

2）CISC和RISC
CISC缺点：复杂，无法产生高效代码；强调中控制，降低机器处理速度，CISC研制周期长，成品率低
RISC关键技术：
- 重叠寄存器窗技术
- 优化编译技术
- 超流水及超标量技术
- 硬布线逻辑与微程序结合在微程序技术中

优化：思路：面向高级程序语言优化和面向操作系统优化

3）流水处理
- 控制方式：
  - 指令控制方式
    - 顺序方式
    - 重叠方式
    - 流水方式
  - 种类
    - 部件级、处理机级、系统级流水
    - 单功能和多功能流水线
    - 静态和动态流水线
    - 线性流水线和非线性流水线
    - 同步流水线和异步流水线
    - 标量流水线和向量流水线
  - 处理
    - 转移指令
    - 超流水线
    - 超标量
    - 超长指令字
  - 时间：$1/max{\{\Delta t_1,\Delta t_2, ...\}}$
  - 建立时间：$T_0$

#### 4 阵列处理机、并行处理机和多处理机

1. 并行处理分类：
   - 存储器操作并行
   - 处理器操作步骤并行
   - 处理器操作并行
   - 指令、任务、作业并行
2. 阵列处理机：
   - 多个处理单元（PU）按照一定方式连成阵列，在单个控制部件（CU）下对分配给自己的数据进行处理，并行完成一条指令规定动作。
3. 并行处理机（SIMD【分布式处理器和共享处理器两种】和MIMD处理机）
4. 多处理机：由多台处理机组成的系统。
5. 其他计算机（集群）
### 2.2 存储系统
#### 存储器的层次结构
CPU内部的通用寄存器组、内部Cache、外部Cache、主存储器、在线磁盘存储器、脱机存储器
#### 分类
- 位置
  - 内存
  - 外存
- 构成材料分类：
  - 磁存储器
  - 半导体存储器
  - 光存储器
- 工作方式：
  - 读/写存储器
  - 只读存储器
    - 固定只读存储器
    - 可编程只读存储器
    - 可擦除可编程存储器
    - 电擦除可编程只读存储器
    - 闪速存储器
- 访问方式
  - 按地址访问
  - 按内容访问
- 寻址方式
  - 随机存储器
  - 顺序存储器
  - 直接存储器
#### 相联存储器
把数据或数据得到一部分作为关键字，按顺序写入信息。读出时并行将关键字与存储器中的每一单元比较。适用于信息检索更新。

一般适用于高速缓冲存储器中，虚拟存储器中用来作为段表、页表或快表存储器，用在数据库和知识库中

#### 高速缓存
组成......


地址映像方法
- 直接映像
- 全相联映像
- 组相联映像

替换算法
- 随机替换
- 先进先出
- 近期最少使用
- 优化替换算法

Cache性能分析
- 命中率
- 命中的访问时间

多级Cache
- L1分指令和数据
- L2 Cache
- L3 Cache
  
#### 虚拟存储器：可以优化使用效率

#### 外存储器
- 磁表面存储器
- 光盘存储器
- 固态硬盘

#### 磁盘阵列技术
- RAID-0
- RAID-1  N
- RAID-2  N/2
- RAID-3
- RAID-4
- RAID-5  N-1 
- RAID-6  N-2
  
RAID之间可以复合使用

#### 存储域网络(SAN)

### 2.3 输入/输出技术
#### 微型计算机中最常用的内存与接口的编址方法

1）内存与接口地址独立编址方法（易于使用和辨认。但指令少，功能弱）

2）内存与接口地址统一编址方法（内存指令可以用于接口。但导致内存地址不连续）

#### 直接程序控制
无条件传送。认为外设总是好的。无条件向程序输出数据

程序查询方式。降低了CPU的效率，但无法做出实时响应
#### 中断方式
中断方式因为CPU无需等待而提高了使用效率。

1）中断处理方法
* 多中断信号线法
* 中断软件查询法
* 菊花链法
* 总线仲裁法
* 中断向量表法
  
2）中断优先级控制
* CPU优先响应优先级高的中断源
* 优先级高的来时，无论如何，都先运行高优先级的中断

中断嵌套

#### 直接存储器存取方式
* 外设向DMA传送请求
* DMA向CPU提出请求
* CPU完成总线周期后立即对请求做出回应，并将总线控制权交给DMAC
* DMAC实施控制
* DMAC送出地址信号和控制信号，实现数据告诉传送
* DMAC完成传送后，撤销对CPU的请求。CPU重新获取到总线控制权

#### 输入/输出处理机（IOP）
通道又称输入/输出处理机。它可以实现对外围设备的统一管理。并大大提高了CPU效率

外围处理机方式是通道方式的进一步扩展。PPU是专用处理机。

### 2.4 总线结构
总线是计算机设备和设备之间传输信息的公共数据通道。总线上的所有设备共享。

分类
* 数据总线
* 地址总线
* 控制总线

常见总线
* ISA
* EISA
* PCI
* PCI Express
* 前端总线
* RS-232C
* SCSI
* SATA
* USB
* IEEE-1394
* IEEE-488

## 3. 安全性、可靠性与系统性能评测基础知识
### 3.1 概述
#### 安全等级
1. 常用的评估准则
  * TCSEC
  * CTCPEC
  * FC
  * ITSEC
  * CC

2. 安全等级

A1 B3 B2 B1 C2 C1 D
#### 安全威胁
授权侵犯、拒绝服务、窃听

信息泄露、截获/修改

假冒、否认、非法使用

人员疏忽、完整性破坏

媒体清理、物理入侵、资源耗尽

#### 影响因素
内部因素
    
    加密、规划、备份等

外部因素

    秘密等级分配等

### 3.2 加密技术和认证技术
#### 加密技术
加密：$C=E_{K_1}(P)$

解密：$P=D_{K_2}(C)$

C密文，P原文，E加密，D解密。

对称加密技术：

DES、3DES/TDEA、RC-5、IDEA、AES

非对称加密技术：

RSA加密算法：

    两个大素数，令n=pq，z=(p-1)(q-1)
    选择d与z互质，选择e，使得ed=1(mod z)

困难点在于素数分解的困难性

密钥管理：
- 密钥产生：CA中心、用户保留等。
- 密钥备份和恢复
- 密钥更新
- 多密钥的管理（KDC）

#### 认证技术
方法：账户名/口令认证、摘要算法认证、PKI的认证

PKI系统包含的要素
- 认证机构
- 数字证书库
- 密钥备份和恢复系统
- 证书作废系统
- 应用接口

PKI标准化的两个方面：PKCS和PKIS

1）哈希函数与信息摘要（MD）
哈希函数，用于产生字符串摘要
MD5用于处理加密的哈希函数

  MD5的特点：
   * 压缩性
   * 容易计算
   * 抗修改性
   * 强抗碰撞

2）数字签名和数字加密
过程。优势

保证了数据的保密性

3）SSL协议：

提供服务：
- 用户和服务器合法性认证
- 加密数据以隐藏被传送数据
- 保护数据完整性

过程：
- 接通
- 密码交换
- 会谈密码阶段
- 检验阶段
- 客户认证阶段
- 结束阶段

4）数字时间戳技术
包含内容
- 需要加时间戳的文件摘要
- DTS受到文件日期和时间
- DTS的数字签名

### 3.3 计算机可靠性
#### 1.概述
1. 可靠性（R）、失效率（λ）的概念
$R(t)=e^{-\lambda t}$（t为时间）
2. 平均无故障时间（MBTF）：
   $MBTF=1/\lambda$
3. 平均修复时间（MTRF）和可用性：
    $A=\frac {MTBF} {MTBF+MTRF}$

#### 2.可靠性模型
1. 串联系统可靠性：乘积；失效率：和
2. 并联系统：可靠性：$R=1-(1-R_1)(1-R_2)...(1-R_N)$；失效率：$\frac{1}{\frac{1}{\lambda} \sum_{j=1}^N \frac{1}{j}}$
3. N模冗余系统：$R=\sum^N_{i=n+1}\begin{pmatrix}j\\N\end{pmatrix}×R^j_0(1-R_0)^{N-i}$。其中，$\begin{pmatrix}j\\N\end{pmatrix}$表示从N个元素中取出i个元素的组合数

提高可靠性措施：
* 提高元器件质量
* 发展容错技术

### 3.4 性能评价

#### 常用方法
1. 时钟频率
2. 指令执行速度(MIPS,KIPS,MFLOPS)
3. 等效指令速度法（$T=\sum^n_{i=1} (w_i*t_i)$）其中，n为指令速度
4. 数据处理速率
5. 核心程序法

#### 基准测试程序
1. 整数程序法
2. 浮点测试程序
   a. 理论峰值测试程序
   b. Linpack基准测试程序
   c. Whetstone基准测试程序
3. SPEC基准程序
4. TPC基准程序