# 存储管理
存储管理的对象是内存或者叫主存或者内存。

## 基本概念：
1. 存储器结构：寄存器-主存-外存结构、寄存器-缓存-主存-存储组织的功能外存结构
   （1）虚拟地址：数据存放的地址；
   （2）地址空间：程序中由符号名组成的空间；
   （3）存储空间：逻辑地址空间是逻辑地址集合；物理地址空间（存储空间）是物理地址集合）
2. 地址重定位：解决主存中逻辑地址和物理地址之间的对应关系的问题。
   （1）静态重定位。
   （2）动态重定位

## 存储管理方案
1. 分区存储管理
   - 固定分区
   - 可变分区
     - 最佳适应算法
     - 首次适应算法
     - 最差适应算法
     - 循环首次适应算法
   - 可重定位分区
2. 分区保护
   - 上界/下界寄存器保护。访问地址不得越界
   - 基址/限长寄存器保护。形成的物理地址不得低于基址寄存器和基址寄存器+限长寄存器的界限。

## 分页存储管理
一个解决了分区存储管理方案中分区靠拢的操作过于耗费系统时间的方案。

1. 纯分页存储管理
   - 分页原理：将一个进程的地址空间划分成若干个大小相等的区域，称为页。将主存划分为若干个和页大小相同的若干个物理块称为块或页框。进程分配内存时，进程中若干页装入多个不相邻接的块中。
   - 地址结构：页号+页内地址
   - 页表：将每一页存储关系放置在系统中的页表中，实现分页存储管理。越界判断等。
2. 快表：使用联想存储器，将页表中的访问频率比较高的少数活动页中的信息存储在里面。这个表是在纯分页存储管理之中进行的。
3. 两级页表机制：通过建立一个外层页表，将页表进行分页。一个是页表目录表，存放物理地址，还有一个是页表，存放页的块号。地址结构为：外层页号|外层页内地址|页内地址
## 分段存储管理
作业地址空间被划分成若干段，每一段都是一组完整的逻辑信息，比如说主程序段、子程序段等。每个段都有自己的名字。

地址结构：段号+段内地址。

通过段表寄存器来实现物理地址变换功能。

注意：请考虑越界问题。

## 段页式存储管理
对于程序，先分段，再分页。对于主存，只分页。

地址结构：段号+段内页号+业内地址。

通过段表和页表实现地址变换。

注意：考虑一下越界问题。

## 虚拟存储管理
主要原因：作业太大，主存装不下。
1. 程序局部性原理：在一段时间内，程序只执行某一个部分，访问的存储空间也局限于一部分。
   - 时间局限性
   - 空间局限性
2. 虚拟存储器实现：主要实现将作业的一部分装入主存中便可以运行作业的存储器系统。具备请求调入功能和置换功能。在逻辑上，将主存容量进行扩充的一种虚拟存储器系统。实现方式：
   - 请求分页系统
   - 请求分段系统
   - 请求段页式系统
3. 请求分页管理器的实现：再分页存储管理系统实现的基础上实现。
   通过产生缺页中断，将相关的页信息存储进主存中。
4. 页面置换算法：
   - 最佳置换算法：无法实现。看最后使用频率决定。
   - 先进先出置换算法
   - 最近最少未使用算法：需要统计相关页使用情况，然后置换使用的页面。
   - 最近未使用算法：最近一次没有使用的算法。
5. 工作集：将程序的工作集驻留再内存中。减少抖动。需要正确选择工作集大小，将需要交换的页面提前调入内存中，从而大大减少缺页率。